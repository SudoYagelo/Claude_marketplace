# 1C Code Standards - Плагин Claude Code

Плагин для автоматической проверки и исправления кода 1С:Предприятие 8 согласно официальным стандартам разработки.

## Возможности

### Slash-команды

Плагин предоставляет следующие команды:

- `/check-1c [файл]` - Проверить код 1С на соответствие стандартам
- `/fix-1c [файл]` - Автоматически исправить код согласно стандартам
- `/format-1c [файл]` - Форматировать код (отступы, пробелы, переносы строк)
- `/analyze-1c-structure` - Проанализировать структуру модуля 1С

### Agent Skills

**1c-code-checker**
Автоматически проверяет код 1С на соответствие стандартам разработки, включая:
- Правила именования (CamelCase, имена процедур/функций)
- Структуру модулей (#Область)
- Форматирование кода
- Документирование функций
- Использование параметра "Отказ"

**1c-code-fixer**
Автоматически исправляет найденные нарушения стандартов:
- Форматирование кода (табуляция, длина строк)
- Структура областей модуля
- Добавление недостающей документации
- Исправление имен переменных и функций

**1c-documentation-generator**
Генерирует документацию для экспортных процедур и функций согласно стандартам 1С:
- Секция "Описание"
- Секция "Параметры" с типами
- Секция "Возвращаемое значение"
- Секция "Пример"

## Проверяемые стандарты

Плагин проверяет соответствие следующим стандартам 1С:

### 1. Общие правила оформления (#std456)
- ✅ Русский язык без буквы "ё"
- ✅ Отсутствие закомментированного кода
- ✅ Отсутствие отладочного кода
- ✅ Табуляция 4 символа
- ✅ Максимальная длина строки 120 символов
- ✅ Один оператор в строке

### 2. Структура модуля (#std455)
- ✅ Правильная последовательность областей
- ✅ Корректные названия областей
- ✅ Заголовок модуля с описанием

### 3. Именование (#std454, #std647)
- ✅ CamelCase для всех имен
- ✅ Процедуры - от глагола в неопределенной форме
- ✅ Функции - от описания результата
- ✅ Нет односимвольных имен (кроме счетчиков)
- ✅ Имена не начинаются с подчеркивания

### 4. Параметры (#std640, #std641)
- ✅ Порядок: от общего к частному
- ✅ Обязательные параметры перед необязательными
- ✅ Не более 7 параметров
- ✅ Структуры через функции-конструкторы

### 5. Документирование (#std453)
- ✅ Все экспортные функции документированы
- ✅ Описание начинается с глагола
- ✅ Параметры описаны с типами
- ✅ Возвращаемое значение описано

### 6. Обработка событий (#std686)
- ✅ Параметр "Отказ" только в Истина
- ✅ Информирование пользователя при отказе

## Установка

### Локальная установка

1. Скопируйте директорию плагина в папку плагинов Claude Code:
   ```bash
   # Linux/macOS
   cp -r . ~/.claude/plugins/1c-code-standards

   # Windows
   xcopy /E /I . %USERPROFILE%\.claude\plugins\1c-code-standards
   ```

2. Перезагрузите Claude Code для активации плагина

### Установка для конкретного проекта

Разместите плагин в директории `.claude/plugins/` вашего проекта:

```bash
mkdir -p .claude/plugins
cp -r . .claude/plugins/1c-code-standards
```

## Использование

### Проверка кода

```
/check-1c МодульОбщегоНазначения.bsl
```

Плагин выдаст подробный отчет о найденных нарушениях с указанием номеров строк и рекомендациями по исправлению.

### Автоматическое исправление

```
/fix-1c МодульОбщегоНазначения.bsl
```

Плагин автоматически исправит найденные нарушения и сохранит изменения.

### Форматирование кода

```
/format-1c МодульОбщегоНазначения.bsl
```

Исправляет только форматирование:
- Табуляция вместо пробелов
- Длина строк
- Пробелы вокруг операторов
- Переносы строк

### Анализ структуры модуля

```
/analyze-1c-structure
```

Анализирует структуру текущего модуля и проверяет:
- Наличие всех необходимых областей
- Правильный порядок областей
- Соответствие типу модуля (общий модуль, форма, объект и т.д.)

### Автоматическое использование skills

Skills активируются автоматически, когда вы запрашиваете:
- "Проверь этот код 1С на ошибки" → активируется `1c-code-checker`
- "Исправь код согласно стандартам 1С" → активируется `1c-code-fixer`
- "Создай документацию для этой функции" → активируется `1c-documentation-generator`

## Примеры

### Пример проверки

**Входной код:**
```1c
Функция получитьДанные()
  рез = новый Массив;
  возврат рез;
КонецФункции
```

**Отчет:**
```
❌ Строка 1: Нарушение #std647 - Имя функции должно быть в CamelCase
   Было: получитьДанные
   Должно быть: ПолучитьДанные

❌ Строка 2: Нарушение #std454 - Имя переменной слишком короткое
   Было: рез
   Рекомендуется: Результат

❌ Строка 1: Нарушение #std453 - Отсутствует документация для экспортной функции

✅ Найдено нарушений: 3
```

### Пример исправления

**После /fix-1c:**
```1c
// Возвращает новый массив данных.
//
// Возвращаемое значение:
//  Массив - пустой массив для заполнения данными.
//
Функция ПолучитьДанные() Экспорт
	Результат = Новый Массив;
	Возврат Результат;
КонецФункции
```

## Структура плагина

```
1c-code-standards/
├── .claude-plugin/
│   └── plugin.json                    # Манифест плагина
├── commands/                           # Slash-команды
│   ├── check-1c.md
│   ├── fix-1c.md
│   ├── format-1c.md
│   └── analyze-1c-structure.md
├── skills/                             # Agent skills
│   ├── 1c-code-checker/
│   │   └── SKILL.md
│   ├── 1c-code-fixer/
│   │   └── SKILL.md
│   └── 1c-documentation-generator/
│       └── SKILL.md
├── 1C_Coding_Standards_LLM.md         # Эталонные стандарты
└── README.md                           # Этот файл
```

## Настройка

### Файл стандартов

Плагин использует файл `1C_Coding_Standards_LLM.md` как эталон стандартов. Вы можете изменить этот файл для адаптации под требования вашей компании.

### Уровни строгости

В будущих версиях будет возможность настройки уровней строгости проверки:
- **Строгий** - все правила обязательны
- **Рекомендованный** - пропускает некритичные нарушения
- **Базовый** - только критичные нарушения

## Известные ограничения

- Плагин не может проверить логику работы кода
- Некоторые сложные случаи именования могут требовать ручной проверки
- Автоисправление может изменить форматирование, требуется финальная проверка
- Плагин не заменяет полноценное тестирование кода

## Разработка

### Добавление новых проверок

1. Обновите файл стандартов `1C_Coding_Standards_LLM.md`
2. Добавьте соответствующие правила в skills
3. Протестируйте на реальных модулях 1С

### Локальное тестирование

1. Внесите изменения в файлы плагина
2. Перезагрузите Claude Code
3. Протестируйте команды на примерах модулей
4. Проверьте отчеты и исправления

## Поддерживаемые типы модулей

- ✅ Общие модули
- ✅ Модули объектов (документы, справочники, регистры)
- ✅ Модули форм
- ✅ Модули команд
- ✅ Модули обработок и отчетов
- ✅ Модули менеджеров значений
- ✅ Модули наборов записей

## Полезные ссылки

- [Стандарты разработки 1С](https://its.1c.ru/db/v8std)
- [Документация Claude Code](https://code.claude.com/docs/)
- [Документация плагинов](https://code.claude.com/docs/en/plugins.md)

## Лицензия

MIT

## Участие в разработке

Приветствуются предложения и pull request'ы! Пожалуйста, создавайте issue для обсуждения изменений.

## Авторы

Разработано для улучшения качества кода 1С:Предприятие
