# Стандарты разработки 1С: Соглашения при написании кода

> **Назначение**: Этот документ содержит полный свод правил и стандартов написания кода для платформы 1С:Предприятие 8.
> **Область применения**: Управляемое приложение, мобильное приложение, обычное приложение.
> **Для использования**: LLM-агентами, плагинами автоматической проверки и исправления кода, разработчиками.

---

## Оглавление

1. [Общие правила оформления текста модулей](#1-общие-правила-оформления-текста-модулей)
2. [Структура программного модуля](#2-структура-программного-модуля)
3. [Правила образования имен](#3-правила-образования-имен)
4. [Процедуры и функции](#4-процедуры-и-функции)
5. [Параметры процедур и функций](#5-параметры-процедур-и-функций)
6. [Документирование кода](#6-документирование-кода)
7. [Обработка событий](#7-обработка-событий)
8. [Практические примеры](#8-практические-примеры)

---

## 1. Общие правила оформления текста модулей

### 1.1. Язык и кодировка (#std456)

#### Обязательные требования:

- ✅ **Русский язык**: Все тексты модулей должны быть написаны на русском языке
  - ❌ **Исключение**: веб-сервисы (методы и параметры на английском), идентификаторы внешних систем

- ❌ **Буква "ё"**: Не использовать букву "ё" в коде
  - ✅ **Исключение**: интерфейсные тексты для пользователя (сообщения, формы, справка)

- ❌ **Специальные символы**: Не использовать:
  - Неразрывные пробелы
  - Знак минус в других кодировках (тире, длинное тире и т.п.)

```1c
// ❌ НЕПРАВИЛЬНО
Процедура ПолучитьДанныеСЁрвера() // буква ё
	Результат = 10 – 5; // длинное тире вместо минуса
КонецПроцедуры

// ✅ ПРАВИЛЬНО
Процедура ПолучитьДанныеСервера()
	Результат = 10 - 5; // обычный минус
КонецПроцедуры
```

### 1.2. Чистота кода

#### Запрещено:

- ❌ Неиспользуемые процедуры и функции
- ❌ Закомментированный код
- ❌ Отладочный код (TODO, MRG, служебные отметки)
- ❌ Ссылки на конкретных разработчиков

```1c
// ❌ НЕПРАВИЛЬНО
Процедура ПередУдалением(Отказ)
	// Если Истина Тогда
	// 	Сообщение("Для отладки");
	// КонецЕсли;

	// Иванов: доделать
КонецПроцедуры

// ✅ ПРАВИЛЬНО - удалить весь обработчик, если он не нужен
```

#### Запрещено использовать комментарии для модификации запросов:

```1c
// ❌ НЕПРАВИЛЬНО
ТекстЗапроса = "ВЫБРАТЬ
|	Контрагенты.Ссылка КАК Ссылка
|// ПОМЕСТИТЬ втКонтрагенты
|ИЗ
|	Справочник.Контрагенты КАК Контрагенты";

Если ВыгрузитьВоВременнуюТаблицу Тогда
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "// ПОМЕСТИТЬ", "ПОМЕСТИТЬ");
КонецЕсли;

// ✅ ПРАВИЛЬНО - использовать конструктор запросов или условные блоки
```

### 1.3. Форматирование кода

#### Один оператор в одной строке:

```1c
// ✅ Допустимо для однотипных операторов присваивания
НачальныйИндекс = 0; Индекс = 0; Результат = 0;
```

#### Синтаксический отступ:

- **Использовать табуляцию** (не пробелы)
- **Размер табуляции**: 4 символа

#### С крайней левой позиции начинаются только:

- Операторы `Процедура`, `КонецПроцедуры`, `Функция`, `КонецФункции`
- Заголовки процедур и функций
- Объявление переменных модуля
- Код вне процедур и функций
- Директивы компилятора (`&НаКлиенте`, `&НаСервере`)
- Аннотации (`&Перед`, `&После`)
- Инструкции препроцессора (`#Область`, `#КонецОбласти`)

```1c
// ✅ ПРАВИЛЬНО
Перем ГлобальнаяПеременная;

#Область ПрограммныйИнтерфейс

&НаСервере
Функция ПолучитьДанные()
	Результат = Новый Массив;
	Возврат Результат;
КонецФункции

#КонецОбласти
```

#### Транзакции НЕ являются операторными скобками:

```1c
// ✅ ПРАВИЛЬНО - без дополнительного сдвига
НачатьТранзакцию();
Попытка
	// Код транзакции
	ЗафиксироватьТранзакцию();
Исключение
	ОтменитьТранзакцию();
КонецПопытки;
```

### 1.4. Длина строки

- **Максимум**: 120 символов (включая табуляцию = 4 символа)
- **Исключение**: длинные строковые константы, которые выводятся без переносов

```1c
// ❌ НЕПРАВИЛЬНО - строка слишком длинная
Результат = ВыполнитьОченьДлиннуюФункциюСМножествомПараметров(Параметр1, Параметр2, Параметр3, Параметр4, Параметр5, Параметр6);

// ✅ ПРАВИЛЬНО - перенос
Результат = ВыполнитьОченьДлиннуюФункциюСМножествомПараметров(
	Параметр1,
	Параметр2,
	Параметр3,
	Параметр4,
	Параметр5,
	Параметр6);
```

### 1.5. Комментарии

#### Общие правила:

- Комментарии должны быть понятными и поясняющими
- Текст на русском языке, деловой стиль
- Эмоционально сдержанные
- Относятся к функциональности программы

#### Небольшие комментарии:

```1c
// ✅ В конце строки
НайденныеОшибки.Колонки.Добавить("Номер"); // для совместимости
```

#### Большие комментарии:

```1c
// ✅ Перед комментируемым кодом, с пробелом после //
// Инициализируем переменные для выполнения расчетов,
// которые выполняются далее по тексту модуля.
ТекущаяДата = ОбщегоНазначения.ПолучитьРабочуюДату();
ТекущийГод = Год(ТекущаяДата);
ТекущийМесяц = Месяц(ТекущаяДата);
```

### 1.6. Области кода

Тексты больших процедур и функций можно разбивать на сворачиваемые области:

```1c
#Область РасчетЦен
	// Код расчета цен
#КонецОбласти

#Область ЗаполнениеДокумента
	// Код заполнения
#КонецОбласти
```

---

## 2. Структура программного модуля

### 2.1. Общая структура (#std455)

Программный модуль может содержать следующие разделы **в указанной последовательности**:

1. **Заголовок модуля** (комментарий с описанием)
2. **Раздел описания переменных**
3. **Экспортные процедуры и функции** (программный интерфейс)
4. **Обработчики событий** объекта/формы
5. **Служебные процедуры и функции**
6. **Раздел инициализации**

### 2.2. Шаблоны разделов

#### 2.2.1. Общие модули

```1c
#Область ПрограммныйИнтерфейс
// Код процедур и функций
#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс
// Код процедур и функций
#КонецОбласти

#Область СлужебныеПроцедурыИФункции
// Код процедур и функций
#КонецОбласти
```

**Описание разделов:**

- **ПрограммныйИнтерфейс**: Экспортные процедуры для использования другими объектами или внешними программами
- **СлужебныйПрограммныйИнтерфейс**: Экспортные процедуры для вызова только из других подсистем той же библиотеки
- **СлужебныеПроцедурыИФункции**: Внутренняя реализация модуля

#### 2.2.2. Модули объектов, обработок, отчетов

```1c
#Область ОписаниеПеременных
#КонецОбласти

#Область ПрограммныйИнтерфейс
// Код процедур и функций
#КонецОбласти

#Область ОбработчикиСобытий
// Код процедур и функций
#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс
// Код процедур и функций
#КонецОбласти

#Область СлужебныеПроцедурыИФункции
// Код процедур и функций
#КонецОбласти

#Область Инициализация
#КонецОбласти
```

#### 2.2.3. Модули форм

```1c
#Область ОписаниеПеременных
#КонецОбласти

#Область ОбработчикиСобытийФормы
// Код процедур и функций
#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы
// Код процедур и функций
#КонецОбласти

#Область ОбработчикиСобытийЭлементовТаблицыФормы<ИмяТаблицыФормы>
// Код процедур и функций
#КонецОбласти

#Область ОбработчикиКомандФормы
// Код процедур и функций
#КонецОбласти

#Область СлужебныеПроцедурыИФункции
// Код процедур и функций
#КонецОбласти
```

#### 2.2.4. Модули команд

```1c
#Область ОбработчикиСобытий
// Код процедур и функций
#КонецОбласти

#Область СлужебныеПроцедурыИФункции
// Код процедур и функций
#КонецОбласти
```

### 2.3. Заголовок модуля

Комментарий в начале модуля с кратким описанием и условиями применения:

```1c
////////////////////////////////////////////////////////////////////////////////
// Клиентские процедуры и функции общего назначения:
// - для работы со списками в формах;
// - для работы с журналом регистрации;
// - для обработки действий пользователя в процессе редактирования
//   многострочного текста, например комментария в документах;
// - прочее.
//
////////////////////////////////////////////////////////////////////////////////
```

Для модулей форм рекомендуется описывать параметры формы.

### 2.4. Описание переменных

```1c
#Область ОписаниеПеременных

Перем ВалютаУчета;      // Основная валюта учета организации
Перем АдресПоддержки;   // Email для связи с поддержкой

#КонецОбласти
```

### 2.5. Обработчики событий

#### Правило для форм:

У каждого события должна быть **своя процедура-обработчик**. Если одинаковые действия должны выполняться при разных событиях:

```1c
// ❌ НЕПРАВИЛЬНО - один обработчик на несколько событий
&НаКлиенте
Процедура ПоИсполнителюПриИзменении(Элемент)
	ПараметрыОтбора = Новый Соответствие();
	ПараметрыОтбора.Вставить("ПоАвтору", ПоАвтору);
	ПараметрыОтбора.Вставить("ПоИсполнителю", ПоИсполнителю);
	УстановитьОтборСписка(Список, ПараметрыОтбора);
КонецПроцедуры

&НаКлиенте
Процедура ПоАвторуПриИзменении(Элемент)
	ПоИсполнителюПриИзменении(Неопределено); // плохо
КонецПроцедуры

// ✅ ПРАВИЛЬНО - отдельные обработчики + общая процедура
&НаКлиенте
Процедура ПоИсполнителюПриИзменении(Элемент)
	УстановитьОтбор();
КонецПроцедуры

&НаКлиенте
Процедура ПоАвторуПриИзменении(Элемент)
	УстановитьОтбор();
КонецПроцедуры

&НаСервере
Процедура УстановитьОтбор()
	ПараметрыОтбора = Новый Соответствие();
	ПараметрыОтбора.Вставить("ПоАвтору", ПоАвтору);
	ПараметрыОтбора.Вставить("ПоИсполнителю", ПоИсполнителю);
	УстановитьОтборСписка(Список, ПараметрыОтбора);
КонецПроцедуры
```

### 2.6. Раздел инициализации

```1c
#Область Инициализация

АдресПоддержки = "v8@1c.ru";
ВыполнитьИнициализацию();

#КонецОбласти
```

---

## 3. Правила образования имен

### 3.1. Общие принципы

- **От терминов предметной области** - имя должно отражать назначение
- **CamelCase** - каждое слово с прописной буквы, пробелы удаляются
- **Предлоги и местоимения из одной буквы** также с прописной буквы

```1c
// ✅ ПРАВИЛЬНО
ДиалогРаботыСКаталогом
КоличествоПачекВКоробке

// ❌ НЕПРАВИЛЬНО
масРеквизитов
соотвВидИмя
новСтр
```

### 3.2. Имена переменных (#std454)

#### Обязательные требования:

- ❌ НЕ начинать с подчеркивания
- ❌ НЕ использовать односимвольные имена (кроме счетчиков циклов)
- ✅ Для флагов - как пишется истинное значение флага

```1c
// ✅ ПРАВИЛЬНО
Перем ЕстьОшибки;       // Признак наличия ошибок
Перем ЭтоТоварТара;     // Признак, что товар - возвратная тара

// ❌ НЕПРАВИЛЬНО
Перем _privateVar;      // начинается с подчеркивания
Перем f;                // односимвольное имя (кроме счетчика)
```

### 3.3. Имена процедур и функций (#std647)

#### Процедуры:

От **неопределенной формы глагола**, от сути действия:

```1c
// ✅ ПРАВИЛЬНО
Процедура ЗагрузитьКонтрагента()

// ❌ НЕПРАВИЛЬНО
Процедура ЗагрузкаКонтрагента()
```

#### Функции:

От **описания возвращаемого значения**:

```1c
// ✅ ПРАВИЛЬНО
Функция ПолноеИмяПользователя()
Функция ДатаНачалаСеанса()

// ❌ НЕПРАВИЛЬНО
Функция ПолучитьПолноеИмяПользователя()
Функция ОпределитьДатуНачалаСеанса()
```

#### Функции-конструкторы:

Использовать слово **"Новый"**:

```1c
// ✅ ПРАВИЛЬНО
Функция НовоеПолеФормы()
Функция НовыйЭлементСправочникаФайлы()
Функция НоваяТаблицаКоманд()

// ❌ НЕПРАВИЛЬНО
Функция ДобавитьПолеФормы()
Функция СоздатьЭлементСправочникаФайлы()
```

#### Функции-проверки:

Начинать со слова **"Это"** или использовать **причастия**:

```1c
// ✅ ПРАВИЛЬНО
Функция ДокументПроведен()
Функция РеквизитыДокументаИзменены()
Функция ЭтоВнешняяЗадача()

// ❌ НЕПРАВИЛЬНО
Функция ПроверитьПроведенностьДокумента()
Функция ВнешняяЗадача()
```

#### Не описывать типы в именах:

```1c
// ❌ НЕПРАВИЛЬНО
Функция ПолучитьМассивРолейСПравомДобавления()
Функция ПолучитьСтруктуруДополнительныхНастроек()

// ✅ ПРАВИЛЬНО
Функция ИменаРолейСПравомДобавления()
Функция ДополнительныеНастройки()
```

---

## 4. Процедуры и функции

### 4.1. Выбор между процедурой и функцией

- **Процедура** - выполняет действие, не возвращает значение
- **Функция** - возвращает значение (основная задача)

### 4.2. Функции с действием и возвратом значения

Если функция выполняет действие, а возврат значения не главное (например, признак успеха):

```1c
// ✅ ПРАВИЛЬНО
Функция РазрешитьРедактированиеРеквизитовОбъекта(Форма)
	// возвращает Истина/Ложь как признак успеха
```

### 4.3. Специальные глаголы в функциях

Использовать глаголы, когда важен **способ получения** результата:

```1c
// ✅ ПРАВИЛЬНО
Функция ВыбратьДанныеПоПравилу(Правило, ПользовательскиеНастройки)
Функция ПреобразоватьДанныеПоПравилу(НаборыДанных, ПараметрыПреобразования)
```

---

## 5. Параметры процедур и функций

### 5.1. Общие правила (#std640)

#### Имена параметров:

- От терминов предметной области
- Должны быть понятны без дополнительных пояснений

#### Последовательность параметров:

- От **общего к частному**
- Обязательные параметры **перед** необязательными

```1c
// ❌ НЕПРАВИЛЬНО
Процедура ПересчитатьСуммуДокумента(ИмяПоляСумма, ДокументОбъект, СуммаВключаетНДС = Истина)
Процедура ПоменятьЦветПоляФормы(Цвет, ИмяПоля, Форма)

// ✅ ПРАВИЛЬНО
Процедура ПересчитатьСуммуДокумента(ДокументОбъект, ИмяПоляСумма, СуммаВключаетНДС = Истина)
Процедура ПоменятьЦветПоляФормы(Форма, ИмяПоля, Цвет)
```

### 5.2. Количество параметров

- **Максимум**: ~7 параметров
- **Необязательных**: не более ~3

При большом количестве параметров:
1. Группировать в структуры
2. Разделить на несколько функций

```1c
// ❌ НЕПРАВИЛЬНО - слишком много параметров
Функция ДобавитьПолеФормы(ИмяПоля, Заголовок = Неопределено,
	ОбработчикПриИзменении = "", ОбработчикНачалоВыбора = "",
	ШиринаПоля, ЦветФона = Неопределено, ЦветФонаЗаголовка = Неопределено,
	Родитель = Неопределено, КартинкаШапки = Неопределено,
	ПутьКДанным = "", ТолькоПросмотрПоля = Ложь,
	СвязиПараметровВыбора = Неопределено)

// ✅ ПРАВИЛЬНО - минимум параметров + свойства объекта
Функция НовоеПолеФормы(ИмяПоля)
	// Возвращает поле, которое можно настроить через его свойства
КонецФункции

// Вызывающий код:
НовоеПоле = НовоеПолеФормы("СтараяЦена");
НовоеПоле.Заголовок = НСтр("ru='Цена'");
НовоеПоле.ЦветФона = ЦветФона;
НовоеПоле.ЦветТекста = WebЦвета.Серый;
```

#### Группировка в структуру:

```1c
// ❌ НЕПРАВИЛЬНО
Процедура СоздатьЭлементНоменклатуры(Наименование, ТоварУслуга,
	ЕдиницаИзмерения, ВесНетто, ПроверятьУникальность = Истина)

// ✅ ПРАВИЛЬНО
Процедура СоздатьЭлементНоменклатуры(ЗначенияРеквизитов,
	ПроверятьУникальность = Истина)
```

### 5.3. Правила вызова функций

#### Избегать вложенных вызовов:

```1c
// ❌ НЕПРАВИЛЬНО - вложенные вызовы
СтруктураВложений.Вставить(
	ПрисоединенныйФайл.Наименование,
	Новый Картинка(ПолучитьИзВременногоХранилища(
		ПрисоединенныеФайлы.ПолучитьДанныеФайла(
			ПрисоединенныйФайл.Ссылка).СсылкаНаДвоичныеДанныеФайла)));

// ✅ ПРАВИЛЬНО - разбить на операторы
АдресФайлаИзображения = ПрисоединенныеФайлы.ПолучитьДанныеФайла(
	ПрисоединенныйФайл.Ссылка).СсылкаНаДвоичныеДанныеФайла;
ДанныеИзображения = Новый Картинка(
	ПолучитьИзВременногоХранилища(АдресФайлаИзображения));
СтруктураВложений.Вставить(
	ПрисоединенныйФайл.Наименование,
	ДанныеИзображения);
```

✅ **Допустимы** компактные вложенные вызовы:

```1c
// ✅ ПРАВИЛЬНО - компактно и понятно
Предупреждение(НСтр("ru='Для выполнения операции необходимо установить расширение.'"));
ПересчитатьСуммуПоКурсу(Сумма, КурсВалютыНаДату(Валюта));
```

#### Избегать вложенных конструкторов структур:

```1c
// ❌ НЕПРАВИЛЬНО - вложенная структура с множеством свойств
ЗаполнитьЦены(Объект.Товары, ,
	Новый Структура("Дата, Валюта, Соглашение, ПоляЗаполнения",
		Объект.Дата, Объект.Валюта, Объект.Соглашение, "Цена, СтавкаНДС"),
	Новый Структура("ПересчитатьСумму, ПересчитатьСуммуСНДС",
		"КоличествоУпаковок", СтруктураПересчета));

// ✅ ПРАВИЛЬНО - явное создание структур
ПараметрыЗаполнения = Новый Структура;
ПараметрыЗаполнения.Вставить("Дата", Объект.Дата);
ПараметрыЗаполнения.Вставить("Валюта", Объект.Валюта);
ПараметрыЗаполнения.Вставить("Соглашение", Объект.Соглашение);
ПараметрыЗаполнения.Вставить("ПоляЗаполнения", "Цена, СтавкаНДС");

ДействияСИзмененнымиСтроками = Новый Структура;
ДействияСИзмененнымиСтроками.Вставить("ПересчитатьСумму", "КоличествоУпаковок");
ДействияСИзмененнымиСтроками.Вставить("ПересчитатьСуммуСНДС", СтруктураПересчета);

ЗаполнитьЦены(Объект.Товары, ПараметрыЗаполнения, ДействияСИзмененнымиСтроками);
```

✅ **Допустимо** для структур с небольшим числом свойств (не более 3):

```1c
// ✅ ПРАВИЛЬНО - немного свойств
ОбщийПараметр = Новый Структура("Ключ, Значение, Тип", "Код", "001", "Строка");
```

#### Пробелы при вызове:

❌ **Запрещены** пробелы:
- Перед открывающей скобкой
- После открывающей скобки
- Перед закрывающей скобкой
- Перед запятыми (если параметры в одной строке)

```1c
// ❌ НЕПРАВИЛЬНО
НовоеПоле = НовоеПолеФормы ( ИмяПоля , ТипПоля );

// ✅ ПРАВИЛЬНО
НовоеПоле = НовоеПолеФормы(ИмяПоля, ТипПоля);
```

### 5.4. Не пропускать обязательные параметры

```1c
// ❌ НЕПРАВИЛЬНО - пропущен первый параметр
ПоменятьЦветПоляФормы(, "РезультатПроверки", ЦветаСтиля.ПоясняющийОшибкуТекст);
ПоменятьЦветПоляФормы(,,); // пропущены все параметры

// ✅ ПРАВИЛЬНО
ПоменятьЦветПоляФормы(ЭтотОбъект, "РезультатПроверки", Цвет);
```

Если `Неопределено` допустимо, передавать явно или сделать параметр необязательным.

### 5.5. Структуры и таблицы значений как параметры (#std641)

#### Функция-конструктор параметров:

Для функций с параметрами типа `Структура` или `ТаблицаЗначений` создавать функцию-конструктор:

```1c
// Функция-конструктор параметров
Функция ПараметрыЗаполненияЦеныВСтрокеТЧ() Экспорт
	ПараметрыЗаполненияЦен = Новый Структура;
	ПараметрыЗаполненияЦен.Вставить("Дата", ТекущаяДатаСеанса());
	ПараметрыЗаполненияЦен.Вставить("Валюта", ОсновнаяВалюта());
	ПараметрыЗаполненияЦен.Вставить("ПересчитыватьСумму", Истина);
	Возврат ПараметрыЗаполненияЦен;
КонецФункции

// Вызывающий код
ПараметрыЗаполненияЦен = ЦенообразованиеКлиентСервер.ПараметрыЗаполненияЦеныВСтрокеТЧ();
ПараметрыЗаполненияЦен.Дата = Объект.Дата;
ПараметрыЗаполненияЦен.Валюта = Объект.Валюта;

ЦенообразованиеСервер.ЗаполнитьЦеныВСтрокеТЧ(ТекущаяСтрока, ПараметрыЗаполненияЦен);
```

#### Не изменять структуру параметров в вызывающем коде:

❌ Не добавлять свойства, не определенные в конструкторе
❌ Не изменять состав/тип колонок таблицы значений

---

## 6. Документирование кода

### 6.1. Общие принципы (#std453)

- **Обязательно**: экспортные процедуры и функции (программный интерфейс)
- **Рекомендуется**: сложные процедуры и функции
- **Не требуется**: простые процедуры, если назначение понятно из имени

### 6.2. Структура комментария

#### 6.2.1. Секция "Описание"

Описание назначения процедуры/функции. Должно быть достаточным для понимания без просмотра кода.

- Начинать с **глагола** (для процедур и функций)
- Для функций: "Возвращает…", "Проверяет…", "Вычисляет…"
- ❌ НЕ начинать с "Процедура…", "Функция…", или имени

```1c
// ❌ НЕПРАВИЛЬНО
// Конструктор объекта WSПрокси.
Функция WSПрокси(ПараметрыПрокси) Экспорт

// ✅ ПРАВИЛЬНО
// Создает прокси на основе определения веб-сервиса и связывает
// его с точкой подключения веб-сервиса.
Функция WSПрокси(ПараметрыПрокси) Экспорт
```

#### 6.2.2. Секция "Параметры"

Предваряется строкой `Параметры:`, затем описание каждого параметра с новой строки.

**Формат**: `ИмяПараметра - Тип1, Тип2 - описание`

```1c
// Проверяет, что переданные адреса включены в задачу.
//
// Параметры:
//  Адреса - Строка - содержит электронные адреса, разделенные запятой.
//                    Например, support@mycorp.ru, v8@localdomain.
//  ЗадачаИсполнителя - ЗадачаСсылка.ЗадачаИсполнителя
//
Процедура ПроверитьАдресаЗадачи(Адреса, ЗадачаИсполнителя)
```

**Типы**:
- Использовать существующие типы платформы: `Строка`, `Число`, `Булево`, `Дата`
- Составные типы: `СправочникСсылка.Сотрудники`, `ДокументСсылка.ЗаказПокупателя`
- Специальные типы EDT: `ОпределяемыйТип.<Имя>`, `ОбъектМетаданныхОтчет`

**Структуры и таблицы** - ссылка на функцию-конструктор:

```1c
// Параметры:
//  ТекущаяСтрока - СтрокаТабличнойЧасти
//  ПараметрыЗаполненияЦен - см. ЦенообразованиеСервер.ПараметрыЗаполненияЦен
//
Процедура ЗаполнитьЦеныВСтрокеТЧ(ТекущаяСтрока, ПараметрыЗаполненияЦен)
```

**Массивы** - указывать тип элементов:

```1c
// Параметры:
//  СведенияОбОбновлении - Массив из см. ОбновлениеИнформационнойБазы.ПараметрыОбновления
```

**Дополнительные типы** - с новой строки через дефис:

```1c
// Параметры:
//  Реквизиты - Строка - имена реквизитов, перечисленные через запятую.
//                       Например, "Код, Наименование, Родитель".
//            - Структура - в качестве ключа - псевдоним поля,
//                          в качестве значения - фактическое имя поля.
//            - Массив Из Строка - имена реквизитов.
```

#### 6.2.3. Секция "Возвращаемое значение"

Только для функций. Предваряется строкой `Возвращаемое значение:`.

```1c
// Возвращаемое значение:
//  Булево - Истина, если хотя бы одна роль доступна пользователю.
```

Для составных типов - каждый с новой строки:

```1c
// Возвращаемое значение:
//  - ЛюбаяСсылка - ссылка на предопределенный элемент.
//  - Неопределено - если элемент есть в метаданных, но не создан в ИБ.
```

Для структур и таблиц - описание свойств/колонок:

```1c
// Возвращаемое значение:
//  Структура:
//   * Дата - Дата
//   * Валюта - СправочникСсылка.Валюты
//   * ПересчитыватьСумму - Булево
```

Для вложенных структур - увеличивать количество звездочек:

```1c
// Возвращаемое значение:
//  Структура:
//   * КодАдресногоОбъекта - Структура:
//     ** КодРегиона - Число - код региона (длина - 2).
//     ** КодНаселенногоПункта - Число - код населенного пункта (длина - 3).
//     ** КодУлицы - Число - код улицы (длина - 4).
//   * Наименование - Строка
```

#### 6.2.4. Секция "Пример"

Предваряется строкой `Пример:`. С новой строки - код примера.

```1c
// Пример:
//  СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
//      НСтр("ru='%1 пошел в %2'"), "Вася", "Зоопарк") = "Вася пошел в Зоопарк".
```

Для переопределяемых процедур - пример **реализации**, а не вызова:

```1c
// Пример:
//  ОбщиеПараметры.МинимальноНеобходимаяВерсияПлатформы = "8.3.4.365";
//  ОбщиеПараметры.РекомендуемыйОбъемОперативнойПамяти = 2;
```

#### 6.2.5. Устаревшие функции

Первая строка: `Устарела.` + описание замены:

```1c
// Устарела. Следует использовать ОбщегоНазначения.РазделениеВключено и
// ОбщегоНазначения.ДоступноИспользованиеРазделенныхДанных
//
Функция ИспользованиеРазделителяСеанса() Экспорт
```

### 6.3. Избегать избыточных комментариев

```1c
// ❌ НЕПРАВИЛЬНО - избыточный комментарий
// Процедура - обработчик события "ПриОткрытии" формы
//
&НаКлиенте
Процедура ПриОткрытии()

// ❌ НЕПРАВИЛЬНО - не дает дополнительной информации
// Функция возвращает статью движения денежных средств по данным документа
Функция СтатьяДвиженияДенежныхСредств(ДанныеДокумента)
```

### 6.4. Расположение комментария

Комментарий размещается **перед** объявлением, директива компиляции - **после** комментария:

```1c
// ✅ ПРАВИЛЬНО
// Процедура - обработчик события формы ПриСозданииНаСервере.
// Обрабатывает параметры формы и заполняет реквизиты значениями.
//
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
```

---

## 7. Обработка событий

### 7.1. Работа с параметром "Отказ" (#std686)

В обработчиках событий с параметром `Отказ` (ПриЗаписи, ОбработкаПроверкиЗаполнения и т.п.):

#### ❌ НЕ присваивать значение `Ложь`

```1c
// ❌ НЕПРАВИЛЬНО
Процедура ОбработкаПроверкиЗаполнения(Отказ, ПроверяемыеРеквизиты)
	Отказ = ЕстьОшибкиЗаполнения(); // может сбросить предыдущее значение Истина
КонецПроцедуры
```

#### ✅ Устанавливать только в `Истина`

```1c
// ✅ ПРАВИЛЬНО - вариант 1
Процедура ОбработкаПроверкиЗаполнения(Отказ, ПроверяемыеРеквизиты)
	Если ЕстьОшибкиЗаполнения() Тогда
		Отказ = Истина;
	КонецЕсли;
КонецПроцедуры

// ✅ ПРАВИЛЬНО - вариант 2
Отказ = Отказ Или ЕстьОшибкиЗаполнения();
```

#### ✅ Всегда информировать пользователя

```1c
// ❌ НЕПРАВИЛЬНО - не информативно
Процедура ОбработкаПроведения(Отказ, РежимПроведения)
	Если Не ТоваровНаСкладеДостаточно() Тогда
		Отказ = Истина; // пользователь не узнает причину
		Возврат;
	КонецЕсли;
КонецПроцедуры

// ✅ ПРАВИЛЬНО - с информативным сообщением
Процедура ОбработкаПроведения(Отказ, РежимПроведения)
	Если Не ТоваровНаСкладеДостаточно() Тогда
		ТекстСообщения = СтрШаблон(
			НСтр("ru='Не хватает %1 %2 товара %3, на складе %4'"),
			Количество,
			ЕдиницаИзмерения,
			Товар,
			Склад);
		ОбщегоНазначения.СообщитьПользователю(ТекстСообщения,, "Объект.Товары",, Отказ);
	КонецЕсли;
КонецПроцедуры
```

### 7.2. Аналогичные параметры

Те же требования для параметров:
- `СтандартнаяОбработка`
- `Выполнение`

---

## 8. Практические примеры

### 8.1. Пример хорошо оформленного общего модуля

```1c
////////////////////////////////////////////////////////////////////////////////
// Функции для работы с курсами валют
//
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

// Возвращает курс валюты на указанную дату.
// Если дата не указана, возвращается курс на текущую дату сеанса.
//
// Параметры:
//  Валюта - СправочникСсылка.Валюты - валюта для получения курса.
//  Дата - Дата - дата, на которую требуется курс.
//              - Неопределено - используется текущая дата сеанса.
//
// Возвращаемое значение:
//  Число - курс валюты на указанную дату.
//
// Пример:
//  Курс = КурсыВалют.КурсВалютыНаДату(Валюты.USD, ТекущаяДатаСеанса());
//
Функция КурсВалютыНаДату(Валюта, Дата = Неопределено) Экспорт

	Если Дата = Неопределено Тогда
		Дата = ТекущаяДатаСеанса();
	КонецЕсли;

	Запрос = Новый Запрос;
	Запрос.Текст =
		"ВЫБРАТЬ
		|	КурсыВалют.Курс КАК Курс
		|ИЗ
		|	РегистрСведений.КурсыВалют КАК КурсыВалют
		|ГДЕ
		|	КурсыВалют.Валюта = &Валюта
		|	И КурсыВалют.Период <= &Дата
		|
		|УПОРЯДОЧИТЬ ПО
		|	КурсыВалют.Период УБЫВ";

	Запрос.УстановитьПараметр("Валюта", Валюта);
	Запрос.УстановитьПараметр("Дата", КонецДня(Дата));

	Результат = Запрос.Выполнить();

	Если Результат.Пустой() Тогда
		Возврат 1;
	КонецЕсли;

	Выборка = Результат.Выбрать();
	Выборка.Следующий();

	Возврат Выборка.Курс;

КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Обновляет курсы валют из внешнего источника.
//
Процедура ОбновитьКурсыВалют() Экспорт

	// Реализация обновления курсов

КонецПроцедуры

#КонецОбласти
```

### 8.2. Пример модуля формы

```1c
#Область ОписаниеПеременных

Перем КешДанныхФормы; // Кеш для хранения временных данных формы

#КонецОбласти

#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)

	УстановитьПараметрыФормы();
	ЗаполнитьСписокВалют();

КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)

	ПодключитьОбработчикОжидания("ОбновитьКурсы", 60);

КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы

&НаКлиенте
Процедура ВалютаПриИзменении(Элемент)

	ОбновитьКурсНаФорме();

КонецПроцедуры

&НаКлиенте
Процедура ДатаПриИзменении(Элемент)

	ОбновитьКурсНаФорме();

КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура ОбновитьКурсы(Команда)

	ОбновитьКурсыНаСервере();
	ОбновитьКурсНаФорме();

КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура УстановитьПараметрыФормы()

	Если Параметры.Свойство("Валюта") Тогда
		Валюта = Параметры.Валюта;
	КонецЕсли;

	Если Параметры.Свойство("Дата") Тогда
		Дата = Параметры.Дата;
	Иначе
		Дата = ТекущаяДатаСеанса();
	КонецЕсли;

КонецПроцедуры

&НаСервере
Процедура ЗаполнитьСписокВалют()

	Запрос = Новый Запрос;
	Запрос.Текст =
		"ВЫБРАТЬ
		|	Валюты.Ссылка КАК Валюта,
		|	Валюты.Наименование КАК Наименование
		|ИЗ
		|	Справочник.Валюты КАК Валюты
		|ГДЕ
		|	НЕ Валюты.ПометкаУдаления";

	РезультатЗапроса = Запрос.Выполнить();
	СписокВалют.ЗагрузитьЗначения(РезультатЗапроса.Выгрузить().ВыгрузитьКолонку("Валюта"));

КонецПроцедуры

&НаКлиенте
Процедура ОбновитьКурсНаФорме()

	Если Не ЗначениеЗаполнено(Валюта) Тогда
		Возврат;
	КонецЕсли;

	ТекущийКурс = ПолучитьКурсВалютыНаСервере(Валюта, Дата);

КонецПроцедуры

&НаСервереБезКонтекста
Функция ПолучитьКурсВалютыНаСервере(Валюта, Дата)

	Возврат КурсыВалют.КурсВалютыНаДату(Валюта, Дата);

КонецФункции

&НаСервере
Процедура ОбновитьКурсыНаСервере()

	КурсыВалют.ОбновитьКурсыВалют();

КонецПроцедуры

#КонецОбласти
```

### 8.3. Пример функции-конструктора параметров

```1c
// Функция-конструктор параметров процедуры
// ЦенообразованиеСервер.ЗаполнитьЦеныВСтрокеТЧ.
//
// Возвращаемое значение:
//  Структура:
//   * Дата - Дата - дата для расчета цен
//   * Валюта - СправочникСсылка.Валюты - валюта документа
//   * ПересчитыватьСумму - Булево - пересчитывать ли сумму строки
//   * ТипЦен - СправочникСсылка.ТипыЦен - тип цен для заполнения
//
Функция ПараметрыЗаполненияЦеныВСтрокеТЧ() Экспорт

	ПараметрыЗаполненияЦен = Новый Структура;
	ПараметрыЗаполненияЦен.Вставить("Дата", ТекущаяДатаСеанса());
	ПараметрыЗаполненияЦен.Вставить("Валюта", ОсновнаяВалюта());
	ПараметрыЗаполненияЦен.Вставить("ПересчитыватьСумму", Истина);
	ПараметрыЗаполненияЦен.Вставить("ТипЦен", Неопределено);

	Возврат ПараметрыЗаполненияЦен;

КонецФункции
```

---

## Приложение: Быстрая справка

### Чеклист для проверки кода

#### ✅ Общие правила
- [ ] Русский язык без буквы "ё"
- [ ] Нет закомментированного кода
- [ ] Нет отладочного кода (TODO, MRG)
- [ ] Табуляция 4 символа
- [ ] Строки не длиннее 120 символов
- [ ] Один оператор в строке

#### ✅ Структура модуля
- [ ] Разделы в правильной последовательности
- [ ] Области оформлены (#Область / #КонецОбласти)
- [ ] Нет пустых областей
- [ ] Заголовок модуля присутствует

#### ✅ Имена
- [ ] CamelCase (каждое слово с большой буквы)
- [ ] От терминов предметной области
- [ ] Процедуры - от глагола в неопределенной форме
- [ ] Функции - от описания результата
- [ ] Не начинаются с подчеркивания
- [ ] Не односимвольные (кроме счетчиков)

#### ✅ Параметры
- [ ] От общего к частному
- [ ] Обязательные перед необязательными
- [ ] Не более 7 параметров
- [ ] Не более 3 необязательных параметров
- [ ] Структуры - через функции-конструкторы

#### ✅ Документирование
- [ ] Экспортные функции задокументированы
- [ ] Описание начинается с глагола
- [ ] Параметры описаны с типами
- [ ] Возвращаемое значение описано (для функций)
- [ ] Нет избыточных комментариев

#### ✅ Обработка событий
- [ ] Параметр "Отказ" - только Истина
- [ ] При установке "Отказ" - информирование пользователя
- [ ] У каждого события свой обработчик

---

## Завершение

Этот документ содержит полный свод стандартов кодирования 1С для использования в автоматических системах проверки и исправления кода. При создании плагина рекомендуется:

1. **Приоритет проверок**: начинать с обязательных требований (отмечены ✅ и ❌)
2. **Автоисправление**: для простых правил (форматирование, пробелы, табуляция)
3. **Предупреждения**: для сложных правил (структура, именование)
4. **Информация**: для рекомендаций (методическая рекомендация)

Документ основан на официальных стандартах 1С (#std456, #std455, #std647, #std453, #std640, #std641, #std454, #std686).
